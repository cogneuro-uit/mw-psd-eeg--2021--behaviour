---
title: "Supplementary materials for:<br> The Effects of Partial Sleep Deprivation on Mind Wandering, Executive Performance and Affect"
shorttitle: "Supply: PSD on MW, executive performance and affect"
authors:
  - name: Steffen Rygg Aasen
    orcid: 0000-0003-2807-7504
    affiliation: 
      - ref: uit
  - name: Samy Engebø Babiker
    affiliation:
      - ref: uit
  - name: Aurora Marie Kleivik Vangen
    affiliation: 
      - ref: uit 
  - name: Silje Balsnes Haugan
    affiliation: 
      - ref: uit 
  - name: Sanna Aurora Sandell
    affiliation: 
      - ref: uit 
  - name: Gábor Csifcsák
    orcid: 0000-0001-7719-7073
    affiliation: 
      - ref: uit 
  - name: Ingvild Saksvik-Lehouillier
    orcid: 0000-0002-1953-7364
    affiliation: 
      - ref: ntnu
  - name: Julia W. Y. Kam
    orcid: 0000-0002-2369-2148
    affiliation: 
      - ref: kam
  - name: Matthias Mittner
    orcid: 0000-0003-0205-7353
    email: matthias.mittner@uit.no
    affiliation: 
      - ref: uit
    corresponding: true
affiliations: 
  - id: uit
    name: "Department of Psychology, UiT The Arctic University of Norway, Norway"
  - id: ntnu
    name: "Department of Psychology, Norwegian University of Science and Technology, Norway"
  - id: kam
    name: "Department of Psychology, Hotchkiss Brain Institute, University of Calgary, Canada"
bibliography: references.bib

# Format
format:
  apaquarto-docx: default
  apaquarto-html: default
  apaquarto-pdf: default
  apaquarto-typst: default
floatsintext: true

crossref-tbl-title: "Table S" # Default is "Table" 
crossref-fig-title: "Figure S"# Default is "Figure"

# Code settings
editor: source
execute:
  include: false
  echo: false
fig-cap-location: top
tbl-cap-location: top
cap-location: top
---

```{r Parameters, warning=FALSE, message=FALSE}
relative_path <- "../" # b/c quarto 
source( paste0(relative_path, "lib/quarto_load_project.R") )
quarto_load_project(relative_path, load_data_data = T, load_data_scripts = T, load_caches = F)
```

# Supplementary Materials

## Sleep 

Participant 31 did not self-report their normal sleep before the NS test and received special treatment. We used the latest nights of sleep as a proxy for their 3 nights of NS before the NS test. 

<!-- Overall sleep effect -->
Participants demonstrated significantly reduced sleep duration during the PSD period compared to the NS period, as confirmed by both the self-reported, actigraphy and the adjusted sleep estimates. However, considerable inter-individual variability was observed in the magnitude of sleep restriction achieved. Previous research demonstrates that sensitivity to sleep loss varies between, but remains consistent within individuals [@hudson2020; @rupp2012; @vandongen2004; @dennis2017]. This suggests that participants may have naturally modulated their sleep restriction according to their own sensitivity to sleep loss. However, the variability in sleep loss could have occurred because of ambiguous sleep restriction instructions. Sleep restriction protocols typically employ either a fixed time-in-bed [e.g., @hudson2020; @vandongen2004] or predetermined bedtimes [@saksvik-lehouillier2020]. In contrast, our protocol required participants to estimate their own sleep restriction, potentially allowing for less stringent implementation among some individuals. Therefore, the inter-individual variability in sleep loss likely reflects both individual differences in sleep loss and methodological limitations of the protocol. 

<!--# We have some discrepancies, explain how these might arise -->

The self-report and actigraphy did not always provide similar sleep/wake times. The reason for the discrepancies likely stems from two sources: First, participants might have adjusted their reports to meet perceived study expectations (e.g., reporting later bedtimes or earlier wake times than actually experienced). Second, actigraphy has inherent limitations in accurately detecting sleep/wake transitions. For example, actigraphy might misinterpret motionless pre-sleep activities as sleep - such as using a mobile phone in bed, a common phenomenon in modern society [@gradisar2013; @hjetland2021; @hysing2015]. Similarly, it might fail to register actual wake times when participants remain in bed after waking. Regardless of these measurement challenges, our data showed that participants generally slept less during the PSD period compared to the NS period, as indicated by the self-report, actigraphy and most importantly, the adjusted sleep estimates that takes both measures into consideration.

### Shiney

In the Shiny application [@shiney2025; see the application at <https://github.com/cogneuro-uit/mw-psd-eeg--2021--behaviour/tree/master/shiny-sleep-adjustments>], time was visualized on the x-axis, while the actigraphy recorded activity (raw data) and light (log-transformed) were visualized on separate y-axes. Coloured marks highlighted the self-reported and actigraphy sleep onset and wake times. The rest interval was indicated by shaded areas ranging from the sleep attempt to the sleep onset, and the wake time to the rise time for the self-report and actigraphy. The researchers could either adjust two sliders to adjust the time (hours and minutes), providing a third coloured marker, or use two separate buttons to apply the exact values of the self-reported or actigraphy as the onset/wake time. Around each marker, a transparently coloured area of (+-) 15 minutes was presented.


### Adjusted Sleep Estimate 

@fig-onset-wake-diffs indicates the differences between self-reported and actigraphy onset/wake times. 

```{r}
#| label: fig-onset-wake-diffs
#| fig-cap: Differences Between Self-Reported and Actigraphy Sleep Onset and Wake
#| fig-cap-location: top
#| fig-format: svg
#| fig-width: 4.5
#| fig-height: 8
#| fig-dpi: 300
#| apa-note: "(a) Indicate the overall difference between the self-report and actigraphy estimated sleep onset/wake across condition. (b) Indicate the individual relationship between self-reported and actigraphy across conditions. NS = normal sleep, PSD = partial sleep deprivation."
#| ##  META  ##
#| include: true
#| warning: false
#| message: false

figs[["onset-wake_difference"]]
```

@fig-SD-between-modalities indicates the estimated sleep loss during the partial sleep deprivation (PSD) compared to the normal sleep (NS). Note some great discrepancies between red (self-reported) and blue (actigraphy) estimates. 

```{r}
#| label: fig-SD-between-modalities
#| fig-cap: Difference in Sleep Duration Between Sources 
#| fig-cap-location: top
#| fig-format: svg
#| fig-width: 9.5
#| fig-dpi: 300
#| apa-note: "Sleep deprivation is estimated as the sleep lost during the partial sleep deprivation (PSD) period relative to the normal sleep (NS) period. Sleep duration is averaged for the three nights preceding each test, and the difference is calculated as PSD - NS. The black solid line indicates the original acceptance threshold, while the red dashed line indicates the adjusted sleep threshold (the criterion used for the reduced sample). Cases above the 1.5 threshold are highlighted by their associated participant code."
#| ##  META  ##
#| include: true
#| warning: false
#| message: false

figs[["PSD__report_type"]]
```

@fig-sleeptimes-across-source illustrates how self-reported, actigraphy and adjusted sleep variables related to mind wandering (MW). 

```{r}
#| label: fig-sleeptimes-across-source
#| fig-cap-location: top
#| fig-cap: Relationship Between Sleep Loss and Mind Wandering Across Sleep Estimates
#| fig-height: 5
#| fig-dpi: 600
#| apa-note: "Note. Average sleep deprivation is calculated based on the difference from the normal sleep (NS) period, such that 0 indicates each subject’s NS sleep time, and the sleep deprivation indicates the (average) differences from their NS average. Participants 3, 5, 12, and 23 are highlighted to illustrate how mind wandering changed from their NS to their sleep-deprived scores split by sleep measure (separate colours). The solid lines indicate the overall relationship for the three different measure types. PSD = partial sleep deprivation."
#| ##  Meta  ##
#| include: true 
#| warning: false 
#| message: false

figs[["sleep_variables_mw"]]
```

### Test of Differences Between Sleep Estimates Between Self-Reports and Actigraphy

We explored whether there was any significant difference between the modalities (self-report and actigraphy). @tbl-diff-sr-ag shows the result of a simple paired sample Bayesian t-test, indicating that sleep duration but not sleep onset and wake time differed between modalities.

```{r}
#| label: tbl-diff-sr-ag
#| tbl-cap: The Difference in Sleep Estimates Between Self-Report and Actigraphy
#| tbl-cap-location: top
#| ##  META  ##
#| include: true
#| warning: false
#| message: false

tbls[["test_sleep_vars_across_modality"]]
```


```{r}
#| label: tbl-test-diff-sr-ag
#| tbl-cap: "The Difference in Sleep Estimates Between Self-Report and Actigraphy"
#| tbl-cap-location: top
#| ##  META  ##
#| include: true
#| warning: false
#| message: false

tbls[["test_sleep_wake_delay"]]
```


## Continuous model 

@tbl-cont-probes indicates the coefficients for the continuously treated PSD on the various MW types, and @tbl-cont-behav indicates the coefficients for the continuously treated PSD on the behaviours. Bold indicates a difference from the dichotomously treated PSD (see below).

### Probes

```{r}
#| label: tbl-cont-probes
#| tbl-cap: "Continuous Bayesian Model for Mind Wandering, Mind Blanking and Spontaneous Mind Wandering"
#| tbl-cap-location: top
#| ## META ##
#| include: true
#| warning: false
#| message: false

tbls[["cont_probit_model"]]
```

### Behaviour

```{r}
#| label: tbl-cont-behav
#| tbl-cap: "Continuous Bayesian Model for Behavioural Variability and Approximate Entropy"
#| tbl-cap-location: top
#| ## META ##
#| include: true
#| warning: false
#| message: false

tbls[["cont_behav_models"]]
```

## Dichotomous model

### Participants

In the dichotomous model, we treated the partial sleep deprivation as a dichotomous variable. Using our pre-defined criteria for sleep loss,  `r subj$red$exc` participants had to be excluded. This left the dichotomous models with a total sample size of `r subj$red$num` participants with an average age of `r subj$red$age` (*SD* = `r subj$red$age_sd`, range = `r subj$red$age_min`-`r subj$red$age_max`, females = `r subj$red$gender_f`).

### Bayesian Statistical Models

#### Thought Probes

The Bayesian hierarchical ordered-probit models of the thought probes for the dichotomous variable treatment are presented in @tbl-dich-probes. 

```{r}
#| label: tbl-dich-probes
#| tbl-cap: "Dichotomous Bayesian Model for Mind Wandering, Mind Blanking and Spontaneous Mind Wandering"
#| tbl-cap-location: top
#| ## META ##
#| include: true
#| warning: false
#| message: false

tbls[["dich_probit_model"]]
```

#### Behaviour

The Bayesian hierarchical linear model of the behaviour for the dichotomous variable treatment is in @tbl-dich-behav-models.

```{r}
#| label: tbl-dich-behav-models
#| tbl-cap: "Dichotomous Bayesian Model for Behavioural Variability and Approximate Entropy"
#| tbl-cap-location: top
#| # settings
#| include: true
#| warning: false
#| message: false

tbls[["dich_behav_models"]]
```

## Affect

### Pre-Task Affect

::: {.landscape}

```{r}
#| label: tbl-psd-on-pre-task-affect
#| tbl-cap: "Partial Sleep Deprivation on pre-Task Positive and Negative Affect"
#| tbl-cap-location: top
#| ## META ##
#| include: true
#| warning: false
#| message: false

tbls[["psd_on_pre-task_affect"]]
```

### Affect Change Across the Task

```{r}
#| label: tbl-psd-mw-on-pre-task-affect
#| tbl-cap: "The Effect of Partial Sleep Deprivation and Mind Wandering on the Change in Affect Across the Task"
#| tbl-cap-location: top
#| ## META ##
#| include: true
#| warning: false
#| message: false

tbls[["affect-change__psd+mw"]]
```

:::

{{< pagebreak >}}

# References
