---
title: "Supplementary materials: <br> The Effects of Partial Sleep Deprivation on Mind Wandering, Executive Performance and Affect"
shorttitle: "Suppl: PSD on MW, executive performance and affect"
authors:
  - name: Steffen Rygg Aasen
    orcid: 0000-0003-2807-7504
    affiliation: 
      - ref: uit
    roles: 
      - writing
      - data curation
      - investigation
      - formal analysis
      - resources
      - visualization
  - name: Samy Engebø Babiker
    affiliation:
      - ref: previously
      - ref: uit
    roles: 
      - data curation
      - investigation
      - resources
      - editing
  - name: Ingvild Saksvik-Lehouillier
    orcid: 0000-0002-1953-7364
    affiliation: 
      - ref: ntnu
    roles: 
      - resources
      - methodology
      # - editing
  - name: Julia W. Y. Kam
    orcid: 0000-0002-2369-2148
    affiliation: 
      - ref: kam
    roles:
      - editing
  - name: Aurora Marie Kleivik Vangen
    affiliation: 
      - ref: uit 
    roles: 
      - data curation
      - investigation
      - resources
  - name: Silje Balsnes Haugan
    affiliation: 
      - ref: previously
      - ref: uit 
    roles: 
      - data curation
      - investigation
      - resources
  - name: Sanna Aurora Sandell
    affiliation: 
      - ref: previously
      - ref: uit 
    roles: 
      - data curation
      - investigation
      - resources
  - name: Gábor Csifcsák
    orcid: 0000-0001-7719-7073
    affiliation: 
      - ref: uit 
    roles: 
      - conceptualization
      - methodology
      - supervision
      - validation
      - resources
      - editing
  - name: Matthias Mittner
    orcid: 0000-0003-0205-7353
    email: matthias.mittner@uit.no
    affiliation: 
      - ref: uit
    roles: 
      - conceptualization
      - funding acquisition
      - project administration
      - methodology
      - software
      - resources
      - supervision
      - validation
      - visualization
      - editing
    corresponding: true
affiliations: 
  - id: uit
    name: "Department of Psychology, UiT - The Arctic University of Norway, Norway"
  - id: ntnu
    name: "Department of Psychology, Norwegian University of Science and Technology, Norway"
  - id: kam
    name: "Department of Psychology, Hotchkiss Brain Institute, University of Calgary, Canada"
  - id: previously
    name: "Previously associated with"
    
bibliography: references.bib

format:
  apaquarto-docx: default
  apaquarto-html: default
  apaquarto-pdf: default
  apaquarto-typst: default

crossref-fig-title: "Figure S"
fig-title-prefix: "Figure S"
floatsintext: true

execute:
  echo: false
  include: false
---

```{r Parameters, warning=FALSE, message=FALSE}
relative_path <- "../" # b/c quarto 
source( paste0(relative_path, "lib/quarto_load_project.R") )
quarto_load_project(relative_path, load_data_data = T)
```

# Supplementary Materials

## Sleep 

Participant 31 did not self-report their normal sleep before the NS test and received special treatment. We used the latest nights of sleep as a proxy for their 3 nights of NS before the NS test. 

### Adjusted Sleep Estimate 

@fig-SD-between-modalities indicates the estimated sleep loss during the partial sleep deprivation (PSD) compared to the normal sleep (NS).

```{r}
#| label: fig-SD-between-modalities
#| fig-cap: Difference in Sleep Duration Between Sources 
#| fig-cap-location: top
#| fig-format: svg
#| fig-width: 9.5
#| fig-dpi: 300
#| apa-note: "Sleep deprivation compared to the normal sleep (NS). Sleep duration is averaged for the three nights preceding each test, and the difference is calculated as partial sleep deprivation (PSD) - NS. The black solid line indicates the original acceptance threshold, while the red dashed line indicated the adjusted sleep threshold (the criterion used for the reduced sample). Cases above the 1.5 threshold are highlighted by their associated participant code."
#| ##  META  ##
#| include: true
#| warning: false
#| message: false

figs[["PSD__report_type"]]
```

@fig-sleeptimes-across-source illustrates how self-reported, actigraphy and adjusted sleep variables related to mind wandering (MW). 

```{r}
#| label: fig-sleeptimes-across-source
#| fig-cap-location: top
#| fig-cap: Sleep Deprivation Across Sleep Source
#| fig-height: 5
#| fig-dpi: 300
#| apa-note: "NS = normal sleep, PSD = partial sleep deprivation"
#| ##  Meta  ##
#| include: true 
#| warning: false 
#| message: false

figs[["sleep_variables_mw"]]
```


### Test of Differences Between Sleep Estimates Between Modality

We explored whether there was any significant difference between the modalities (self-report and actigraphy). @tbl-diff-sr-ag show the result of a simple paired sample Bayesian t-test, indicating that sleep duration but not sleep onset and wake time differed between modalities.

```{r}
#| label: tbl-diff-sr-ag
#| tbl-cap: The Difference in Sleep Estimates Between Self-Report and Actigraphy
#| tbl-cap-location: top
#| ##  META  ##
#| include: true
#| warning: false
#| message: false

tbls[["test_sleep_vars_across_modality"]]
```

### Sleep and Wake Delay

@fig-delay-in-sleep-and-wake indicates the self-reported delay from sleep attempt to sleep onset and from wake time to rise time. @tbl-test-diff-sr-ag indicate the test statistics, using a simple Bayesian paired-sample t-test, for the sleep delay

```{r}
#| label: fig-delay-in-sleep-and-wake
#| fig-cap: Self-Reported Delay in Sleep Onset and Wake Time
#| fig-cap-location: top
#| fig-format: svg
#| fig-width: 6
#| fig-dpi: 300
#| apa-note: "PSD = partial sleep deprivation, NS = normal sleep"
#| ## Settings
#| include: true
#| message: false
#| warning: false

figs[["delay_in_wake-onset"]]
```


```{r}
#| label: tbl-test-diff-sr-ag
#| tbl-cap: The Difference in Sleep Estimates Between Self-Report and Actigraphy
#| tbl-cap-location: top
#| ##  META  ##
#| include: true
#| warning: false
#| message: false

tbls[["test_sleep_wake_delay"]]
```


### The Relationship Between Sleep Quality and Reduced Sleep

To test whether sleep quality improved with greater PSD, we used a simple Bayesian linear model with sleep quality as the outcome and sleep loss as the predictor. Results are shown presented in @tbl-sleep-quality and illustrated in @fig-sleep-quality-over-sleep-loss, indicating no relationship between sleep loss (hour of reduced sleep) and sleep quality. 

```{r}
#| label: tbl-sleep-quality
#| tbl-cap: The Relationship Between Sleep Loss and Sleep Quality
#| tbl-cap-location: top
#| ##  META  ##
#| include: true
#| warning: false
#| message: false

tbls[["sleep_quality+sleep"]] 
```


```{r}
#| label: fig-sleep-quality-over-sleep-loss
#| fig-cap: The Effect of the Partial Sleep Deprivation on Sleep Quality
#| fig-cap-location: top
#| fig-format: svg
#| fig-width: 5.5
#| fig-dpi: 300
#| apa-note: "PSD = partial sleep deprivation, NS = normal sleep"
#| ## META ## 
#| include: true
#| message: false
#| warning: false

PSD_sleep_quality |>
  ggplot(aes(sleep, sleep_quality_SD, col = name)) +
  # facet_wrap(~name) +
  geom_point(alpha = .5) + 
  geom_smooth(method = "lm", alpha = .07)  +
  labs(x = "Sleep deprivation", y = "Sleep quality", col = "Modality") +
  theme(legend.position = "top")
```


## Dichotomous model

### Participants

@tbl-dichotomous-demo indicate the dichotomous sample demographics. 

```{r age}
#| label: tbl-dichotomous-demo
#| tbl-cap: Dichotomous Sample Demographics
#| tbl-cap-location: top
#| ##  META  ##
#| include: true
#| warning: false
#| message: false

demographics_reduced |> 
  mutate(Age = as.numeric(Age)) |>
  summarise(
    sum = length(Age)
    , female = sum(Gender == 1)
    , male = sum(Gender == 2)
    , missing = sum(is.na(Age))
    , min = min(Age, na.rm = T)
    , mean = mean(Age, na.rm = T)
    , sd = sd(Age, na.rm = T)
    , max = max(Age, na.rm = T)
    , skewness = moments::skewness(Age, na.rm = T)
    , kurtosis = moments::kurtosis(Age, na.rm = T)
  ) |>
  mutate(across(c(mean, sd, skewness, kurtosis), ~fmt_APA_numbers(.x, .chr=T))) |>
  gt() |>
  tab_spanner("Age", c(min, mean, sd, max, skewness, kurtosis)) |>
  tab_spanner("Number", c(sum, female, male, missing)) |>
  cols_label(
    sum = "Total", female = "Female", male = "Male", missing = "Missing",
    min = "Min", mean = md("*M*"), sd = md("*SD*"), max = "Max",
    skewness = "Skew", kurtosis ="Kurt"
  ) |>
  tab_fmt_APA()
```


### Bayesian Statistical Models

#### Thought Probes

The Bayesian hierarchical ordered-probit models of the thought probes for the dichotomous variable treatment is presented in @tbl-dich-probes. Changes in the probe responses over time and conditions are illustrated in @fig-dich-probes-over-time.

```{r}
#| label: tbl-dich-probes
#| tbl-cap: Dichotomous Bayesian Models for Mind Wandering, Mind Blanking and Spontaneous Mind Wandering
#| tbl-cap-location: top
#| ## META ##
#| include: true
#| warning: false
#| message: false

tbls[["dich_probit_model"]]
```

```{r}
#| label: fig-dich-probes-over-time
#| fig-cap: "Thought Probes Over Time Between Conditions"
#| fig-cap-location: top
#| fig-width: 8
#| fig-height: 4.5
#| fig-dpi: 300
#| ## META ##
#| include: true
#| warning: false
#| message: false

figs[["dich_probes_over_time"]]
```

#### Behaviour

The Bayesian hierarchical linear model of the behaviour for the dichotomous variable treatment is in @tbl-dich-behav-models. Changes in behaviour over time and conditions are illustrated in @fig-dich-behav-over-time.

```{r}
#| label: tbl-dich-behav-models
#| tbl-cap: Bayesian Behavioural Models for The Reduced Sample
#| tbl-cap-location: top
#| # settings
#| include: true
#| warning: false
#| message: false

tbls[["dich_behav_models"]]
```

```{r}
#| label: fig-dich-behav-over-time
#| fig-cap: "Behaviour Over Time Between Conditions"
#| fig-cap-location: top
#| fig-width: 8
#| fig-height: 4
#| fig-dpi: 300
#| # settings
#| include: true
#| warning: false
#| message: false

figs[["dich_behav_over_time"]] 
```

